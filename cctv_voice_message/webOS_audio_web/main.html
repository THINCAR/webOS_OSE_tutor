<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/style.css">
    <title>현관문 CCTV</title>
</head>
<body>
    <div class="container">
        <h1 style="font-size: 50px; padding-top: 10px; height: 36px;">방문자 음성메시지</h1>
        <div class="list_box">
            <div class="list1">
                <div id="message0" onclick="select(0);">음성메시지 보낸 사람 : <span id="name0">1</span><img class="trash" src="https://img.icons8.com/material-outlined/24/000000/trash--v1.png" onclick="if(confirm('목록에서 삭제하시겠습니까?')){document.getElementById('message0').style.visibility = 'hidden'}"/></div>
                <div id="message1" onclick="select(1);">음성메시지 보낸 사람 : <span id="name1">1</span><img class="trash" src="https://img.icons8.com/material-outlined/24/000000/trash--v1.png" onclick="if(confirm('목록에서 삭제하시겠습니까?')){document.getElementById('message1').style.visibility = 'hidden'}"/></div>
                <div id="message2" onclick="select(2);">음성메시지 보낸 사람 : <span id="name2">1</span><img class="trash" src="https://img.icons8.com/material-outlined/24/000000/trash--v1.png" onclick="if(confirm('목록에서 삭제하시겠습니까?')){document.getElementById('message2').style.visibility = 'hidden'}"/></div>
                <div id="message3" onclick="select(3);">음성메시지 보낸 사람 : <span id="name3">1</span><img class="trash" src="https://img.icons8.com/material-outlined/24/000000/trash--v1.png" onclick="if(confirm('목록에서 삭제하시겠습니까?')){document.getElementById('message3').style.visibility = 'hidden'}"/></div>
                <div id="message4" onclick="select(4);">음성메시지 보낸 사람 : <span id="name4">1</span><img class="trash" src="https://img.icons8.com/material-outlined/24/000000/trash--v1.png" onclick="if(confirm('목록에서 삭제하시겠습니까?')){document.getElementById('message4').style.visibility = 'hidden'}"/></div>
                <div id="message5" onclick="select(5);">음성메시지 보낸 사람 : <span id="name5">1</span><img class="trash" src="https://img.icons8.com/material-outlined/24/000000/trash--v1.png" onclick="if(confirm('목록에서 삭제하시겠습니까?')){document.getElementById('message5').style.visibility = 'hidden'}"/></div>
                <div id="message6" onclick="select(6);">음성메시지 보낸 사람 : <span id="name6">1</span><img class="trash" src="https://img.icons8.com/material-outlined/24/000000/trash--v1.png" onclick="if(confirm('목록에서 삭제하시겠습니까?')){document.getElementById('message6').style.visibility = 'hidden'}"/></div>
                <div id="message7" onclick="select(7);">음성메시지 보낸 사람 : <span id="name7">1</span><img class="trash" src="https://img.icons8.com/material-outlined/24/000000/trash--v1.png" onclick="if(confirm('목록에서 삭제하시겠습니까?')){document.getElementById('message7').style.visibility = 'hidden'}"/></div>
                <div id="message8" onclick="select(8);">음성메시지 보낸 사람 : <span id="name8">1</span><img class="trash" src="https://img.icons8.com/material-outlined/24/000000/trash--v1.png" onclick="if(confirm('목록에서 삭제하시겠습니까?')){document.getElementById('message8').style.visibility = 'hidden'}"/></div>
                <div id="message9" onclick="select(9);">음성메시지 보낸 사람 : <span id="name9">1</span><img class="trash" src="https://img.icons8.com/material-outlined/24/000000/trash--v1.png" onclick="if(confirm('목록에서 삭제하시겠습니까?')){document.getElementById('message9').style.visibility = 'hidden'}"/></div>
            </div>
            <audio id="audio" src="" controls></audio>
        </div>
    </div>
    <script>
        function select(num) {
            document.getElementById("audio").src = './uploads/result' + num + '.wav'
        }

        for (i=0; i<10; i++) {
            file = "./uploads/name" + i + ".txt";
            var rawFile = new XMLHttpRequest();
            rawFile.open("GET", file, false);
            rawFile.onreadystatechange = function ()
            {
                if(rawFile.readyState === 4)
                {
                    if(rawFile.status === 200 || rawFile.status == 0)
                    {
                        var allText = rawFile.responseText;
                        document.getElementById("name" + i).innerHTML = allText;
                        document.getElementById("message" + i).style.visibility = "visible";
                    }
                    else{
                        document.getElementById("name" + i).innerHTML = "";
                        document.getElementById("message" + i).style.visibility = "hidden";
                    }
                }
            }
            rawFile.send(null);
        }       
    </script>
</body>
</html>